| ID | Name | Type | Shape | Description | Computed by | Sent to |
|---|---|---|---|---|---|---|
| 0 | local\_gram\_matrix | nparray | $(p, p)$ | The gram matrix of the local design matrix $G^{(k)} := (X^{(k)})^{\top}X^{(k)}$. | Each center | Server |
| 0 | local\_features | nparray | $(p, G)$ | $\Phi^{(k)}  := X^{(k)\top} Z^{(k)}$. | Each center | Server |
| 1 | rough\_dispersions | nparray | $(G,)$ | A rough estimate of the dispersions obtained by essentially averaging local rough dispersions ($\alpha^{\texttt{MoM},2}_g = \max(\tfrac{1}{n-p}\sum_k(\alpha^{\texttt{MoM},2}_g)^{(k)},0)$) | Server | Center |
| 2 | local\_inverse\_size\_mean | float | $()$ | The average of the inverse of the size factors in a center $\overline{1/\gamma}^{(k)} = \tfrac{1}{n_k}\sum_{i=1}^{n_k} 1/\gamma^{(k)}_{i}$. | Each center | Server |
| 2 | local\_counts\_mean | nparray | $(G,)$ | The averag e of the counts in a center, per gene $\overline{Y}^{(k)}_{g} = \frac{1}{n_k}\sum_{i=1}^{n_k}Y^{(k)}_{ig}$. | Each center | Server |
| 2 | local\_squared\_squared\_mean | nparray | $(G,)$ | The average of the square normed counts in a center, per gene $\overline{Y^2} := \tfrac{1}{n_k}\sum_{i=1}^{n_k}(Y^{(k)}_{ig})^2$. | Each center | Server |
| 2 | local\_n\_obs | int |  | The number of observations in a center $n_k$. | Each center | Server |
| 2 | rough\_dispersions | nparray | $(G,)$ | The rough estimates computed at the previous step and passed on. | Each center | Server |
| 3 | tot\_counts\_mean | nparray | $(G,)$ | The average of the counts across all centers, per gene, obtained by summing the local counts means. | Server | Center |
| 3 | tot\_num\_samples | int |  | The total number of samples across all centers $n$. | Server | Center |
| 3 | MoM\_dispersions | nparray | $(G,)$ | The dispersions obtained by the method of moments. First, the aggregated mean counts, squared mean counts and inverse size factors are computed ($\overline{1/\gamma} = \sum_k{\tfrac{n_k}{n}~\overline{1/\gamma}^{(k)}) }$, $\overline{Y}_g = \sum_{k}{\tfrac{n_k}{n}~\overline{Y}^{(k)}_{g}}$, $\overline{Y^2} = \sum_{k}{\tfrac{n_k}{n}~\overline{Y^2}^{(k)}_{g})}$). The variance is then estimated with $\widehat{\sigma}^2_g = \tfrac{n}{n-1} (\overline{Y^2}_g - \overline{Y}_g^2)$ and a method of moments estimate is the constructed as $\alpha^{\texttt{MoM},1}_g = \tfrac{\widehat{\sigma}^2_g - \overline{1/\gamma}_g \times \overline{Y}_g}{\overline{Y}_g^2}$. The final MoM estimate $\alpha^{\texttt{MoM}}_g$ for gene $g$ is the clipped value of $\min(\alpha^{\texttt{MoM},1}_g, \alpha^{\texttt{MoM},2}_g)$ between $\texttt{min\_disp}$ and $\max(\texttt{max\_disp},n)$. | Server | Center |
| 3 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Server | Center |
| 5 | gram\_full\_rank | bool | $()$ | A boolean indicating whether the global Gramm matrix $G$ is full rank. | Each center | Server |
| 5 | n\_non\_zero\_genes | int |  | The number of genes with non-zero counts in at least one center. | Each center | Server |
| 5 | local\_log\_features | nparray | $(G_{\texttt{nz}}, p)$ | $\Phi_{k} = (X^{(k)})^{\top} \log(Z^{(k)}+0.1)$. | Each center | Server |
| 5 | global\_gram\_matrix | nparray | $(p, p)$ | The sum of the local Gramm matrix across all centers $G = \sum_k G^{(k)}$. | Each center | Server |
| 6 | round\_number\_irls | int |  | The current round number of the IRLS algorithm. Initialized at $0$. | Server | Center |
| 6 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log likelihood of the negative binomial GLM, initialized at $1000$ for all genes. | Server | Center |
| 6 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Initialized to $\texttt{True}$. | Server | Center |
| 6 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Initialized to $\texttt{False}$. | Server | Center |
| 6 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The initial value of the $\beta$ parameter. If the Gramm matrix is full rank, is set to $\beta_g = G^{-1}(\sum_k\Phi^{(k)}_{g})$ for all genes $g$. Otherwise, it is set as a weighed average of the normed log means, i.e., $\beta_g = \sum_k \tfrac{n_k}{n}~\overline{\log(Z)}^{(k)}_{g}$, where $\overline{\log(Z)}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{\log(Z^{(k)}_{ig})}$ is computed locally. | Server | Center |
| 7 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The updated value of the $\beta$ parameter after applying the IRLS update for the active genes. At the last step, is not updated. | Server | Center |
| 7 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene $g$ is considered to have diverged if any component of $\beta_g \in \mathbb{R}^p$ has absolute value above the threshold $\texttt{max\_beta}$. | Server | Center |
| 7 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose $\beta$ parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene $g$, as $\frac{\left\| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right\|}{\left\| 2  \mathcal{L}(\beta) \right\| + 0.1} $ where $\beta_{g, \text{prev}}$ is the value of $\beta_{g}$ at the previous iteration. If this deviance is smaller than the user inputed $\texttt{beta\_tol}$, the gene is considered to have converged and is set to $\texttt{False}$ in the $\texttt{irls\_mask}$, meaning it will not be optimized further. | Server | Center |
| 7 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log-likelihood at the $\beta_g$ parameter, built by summing the local nlls from the centers. | Server | Center |
| 7 | round\_number\_irls | int |  | The current round number of the IRLS algorithm, incremented by $1$ during the local step. | Server | Center |
| 8 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
| 8 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. As this is the last step of the optimization, a gene $g$ is considered to have diverged not only if the Armijo condition is never satisfied, but also if the convergence criterion is not met. A gene is said to converge if the relative difference between two successive iterates is smaller than a threshold value $\texttt{PQN\_ftol}$, i.e., $\left\|\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_{g,\text{prev}})\right\| \leq \texttt{PQN\_ftol} \max(\mathcal{L}^{\lambda}(\beta_g), \mathcal{L}^{\lambda}(\beta_{g,\text{prev}}),1)$. | Server | Center |
| 8 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}). | Server | Center |
| 10 | unique\_counts | Series | $(p,)$ | A pandas series indexed by unique level combinations (all design factor levels that coexist) and containing the number of samples in each level combination. In the single factor case the index will simply be the unique levels of the factor. | Each center | Server |
| 11 | counts\_by\_lvl | Series | $(L,)$ | A pandas series indexed by the unique levels of the design factors across all centers, and whose values are the number of samples in each level combination. | Server | Center |
| 14 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 14 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 14 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between $\texttt{min\_disp}$ and $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$. | Each center | Server |
| 14 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 14 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 15 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
| 15 | genewise\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 15 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 16 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 16 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 16 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$. | Each center | Server |
| 16 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 16 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 17 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 17 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
| 17 | genewise\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 18 | mean\_normed\_counts | nparray | $(G,)$ | For each gene, the mean of the local normed counts, i.e., $\overline{Z}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{Z^{(k)}_{ig}}$. | Each center | Server |
| 18 | n\_obs | int |  | The number of samples in the center. | Each center | Server |
| 18 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 18 | genewise\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the dispersion parameter $\alpha_g$, as computed by the grid search. | Each center | Server |
| 18 | n\_params | int |  | The number of parameters in the design matrix, i.e., its number of columns. | Each center | Server |
| 19 | disp\_function\_type | str |  | The type of the dispersion function used to model the dispersions. It can be either "parametric", if the iterative scheme to fit the trend curve has converged, the LBFGS-B method used to fit the parameters has converged, and the coefficienst of the trend curve are non-negative; or "mean" otherwise. | Server | Center |
| 19 | mean\_disp | NoneType |  | None if the dispersion function type is "parametric", and the trimmed mean of the genewise dispersions whose value is above $10\times \texttt{min\_disp}$, with trimming proportion $0.001$ otherwise. | Server | Center |
| 19 | fitted\_dispersions | nparray | $(G,)$ | For each gene $g$ with zero counts across all centers, $\texttt{nan}$. For each non-zero gene $g$, either $\alpha_{\texttt{trend}}(\overline{Z}_g)$ if the disp\_function\_type is "parametric" (i.e., the fitting of the parameters has converged), or $\texttt{mean\_disp}$ otherwise (i.e., if the disp\_function\_type is "mean"). Denoted with $\alpha^{\texttt{trend}}_g$. | Server | Center |
| 19 | \_squared\_logres | float | $()$ | The squared mean absolute deviation of the difference between the log of the genewise dispersions and the log of the fitted dispersions, restricted to the non-zero genes whose gene-wise dispersions are above $100\times \texttt{min\_disp}$. The mean absolute deviation estimate is defined as the median of the absolute difference between the log residual and its median, scaled by the percent point function of the normal distribution at $0.75$. | Server | Center |
| 19 | prior\_disp\_var | float | $()$ | A prior on the variance of the log dispersions around the log trend curve $\sigma_{\texttt{trend}}^2$, estimated as the maximum between $0.25$ and $\texttt{\_squared\_log\_res} - \psi_1((n-p)/2)$, where $\psi_1(f/2)$ is the variance of the log of a $\chi^2_f$ distribution. For more details, see \citep{love2014deseq2}. | Server | Center |
| 19 | trend\_coeffs | nparray | $(2,)$ | The coefficients of the trend curve fitted to the dispersions. We model the dispersions $\alpha_g$ of the gene $g$ as a sample from an exponential distribution whose mean $\alpha_{\texttt{trend}}(\overline{Z}_g)$ is a function of $\overline{Z}_g$ parametrized by two coefficients $\alpha_0$ and $\text{a}_1$; $\alpha_{\texttt{trend}}(\overline{Z}_g) = \alpha_0 + \tfrac{\text{a}_1}{\overline{Z}_g}$. $\alpha_{\texttt{trend}}$ is called the trend curve. The coefficients are $(\alpha_0, \text{a}_1)$, and are obtained by starting with the set of non zero genes  and by iteratively i) minimizing the negative log likelihood of the exponential distribution on the set of genes with LBFGS-B and ii) removing the genes where the ratio between the dispersion $\alpha_g$ and the trend curve $\alpha_{\texttt{trend}}(\overline{Z}_g)$ is above $15$ or below $10^{-4}$ (we consider these genes as outliers to this model), until the set of genes is stable (see \citep{love2014deseq2} for more details). | Server | Center |
| 20 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 20 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 20 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between $\texttt{min\_disp}$ and $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$. | Each center | Server |
| 20 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 20 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 20 | reg | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ and $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, a regularization term that is equal to $0.5 \times (\log(\alpha_g) - \log(\alpha^{\texttt{trend}}_g))^2/\sigma_{\texttt{trend}}^2$, and which comes from the prior on the distribution of the log dispersions around the trend curve. | Each center | Server |
| 21 | MAP\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the MAP dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices, and the regularization coming from the prior on the log dispersions around the trend curve. The Cox-Reid, prior regularized nll per gene and per dispersion in the grid is obtained by summing the regularization terms and the nll. Finally, for every gene, the MAP dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 21 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 21 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
| 22 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 22 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 22 | reg | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, a regularization term that is equal to $0.5 \times (\log(\alpha_g) - \log(\alpha^{\texttt{trend}}_g))^2/\sigma_{\texttt{trend}}^2$, and which comes from the prior on the distribution of the log dispersions around the trend curve. | Each center | Server |
| 22 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 22 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 22 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$. | Each center | Server |
| 23 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 23 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
| 23 | MAP\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the MAP dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices, and the regularization coming from the prior on the log dispersions around the trend curve. The Cox-Reid, prior regularized nll per gene and per dispersion in the grid is obtained by summing the regularization terms and the nll. Finally, for every gene, the MAP dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 25 | gram\_full\_rank | bool | $()$ | A boolean indicating whether the global Gramm matrix $G$ is full rank. | Each center | Server |
| 25 | n\_non\_zero\_genes | int |  | The number of genes with non-zero counts in at least one center. | Each center | Server |
| 25 | local\_log\_features | nparray | $(G_{\texttt{nz}}, p)$ | $\Phi_{k} = (X^{(k)})^{\top} \log(Z^{(k)}+0.1)$. | Each center | Server |
| 25 | global\_gram\_matrix | nparray | $(p, p)$ | The sum of the local Gramm matrix across all centers $G = \sum_k G^{(k)}$. | Each center | Server |
| 26 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The initial value of the $\beta$ parameter. If the Gramm matrix is full rank, is set to $\beta_g = G^{-1}(\sum_k\Phi^{(k)}_{g})$ for all genes $g$. Otherwise, it is set as a weighed average of the normed log means, i.e., $\beta_g = \sum_k \tfrac{n_k}{n}~\overline{\log(Z)}^{(k)}_{g}$, where $\overline{\log(Z)}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{\log(Z^{(k)}_{ig})}$ is computed locally. | Server | Center |
| 26 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Initialized to $\texttt{False}$. | Server | Center |
| 26 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Initialized to $\texttt{True}$. | Server | Center |
| 26 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log likelihood of the negative binomial GLM, initialized at $1000$ for all genes. | Server | Center |
| 26 | round\_number\_irls | int |  | The current round number of the IRLS algorithm. Initialized at $0$. | Server | Center |
| 27 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log likelihood at the $\beta_g$ parameter. Simply passed on. | Each center | Server |
| 27 | round\_number\_irls | int |  | The current round number of the IRLS algorithm. Simply passed on. | Each center | Server |
| 27 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Simply passed on. | Each center | Server |
| 27 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on. | Each center | Server |
| 27 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The log fold change $\beta$ parameter. Not modified. | Each center | Server |
| 27 | local\_features | nparray | $(G_{\texttt{act}}, p)$ | For each active gene $g$, the projected features $(X^{(k)})^{\top} W^{(k)}_g \phi^{(k)}_{g}$, where $\phi^{(k)}_{ig} = \log\left(\frac{\mu^{(k)}_{ig}}{\gamma_{i}}\right) + \frac{Y^{(k)}_{ig} - \mu^{(k)}_{ig}}{\mu^{(k)}_{ig}}$ and $\phi^{(k)}_{g}$ is the vector of $(\phi^{(k)}_{ig})_{1 \leq i \leq n_k}$. | Each center | Server |
| 27 | local\_hat\_matrix | nparray | $(G_{\texttt{act}}, p, p)$ | For each gene $g$, the hat matrix  $H^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$ for parameter $\beta$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 27 | local\_nll | nparray | $(G_{\texttt{act}},)$ | For each gene $g$, the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data. | Each center | Server |
| 27 | irls\_gene\_names | Index | $(G_{\texttt{act}},)$ | The gene names of the active genes. | Each center | Server |
| 28 | round\_number\_irls | int |  | The current round number of the IRLS algorithm, incremented by $1$ during the local step. | Server | Center |
| 28 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log-likelihood at the $\beta_g$ parameter, built by summing the local nlls from the centers. | Server | Center |
| 28 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The updated value of the $\beta$ parameter after applying the IRLS update for the active genes. At the last step, is not updated. | Server | Center |
| 28 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene $g$ is considered to have diverged if any component of $\beta_g \in \mathbb{R}^p$ has absolute value above the threshold $\texttt{max\_beta}$. | Server | Center |
| 28 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose $\beta$ parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene $g$, as $\frac{\left\| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right\|}{\left\| 2  \mathcal{L}(\beta) \right\| + 0.1} $ where $\beta_{g, \text{prev}}$ is the value of $\beta_{g}$ at the previous iteration. If this deviance is smaller than the user inputed $\texttt{beta\_tol}$, the gene is considered to have converged and is set to $\texttt{False}$ in the $\texttt{irls\_mask}$, meaning it will not be optimized further. | Server | Center |
| 29 | ascent\_direction\_on\_mask | NoneType |  | The ascent direction on the active genes, which is set to $\texttt{None}$ at the beginning. | Each center | Server |
| 29 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For evert gene $g$, the inital value of the $\beta_g$ parameter for the ProxQuasiNewton algorithm (PQN), which is either i) the value computed by IRLS if IRLS has converged on that gene (in that case, the gene will not be optimized), or ii) the initial value of the $\beta_g$ parameter for the IRLS algorithm, if IRLS has not converged on that gene. | Each center | Server |
| 29 | local\_nll | nparray | $(1, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$. | Each center | Server |
| 29 | local\_fisher | nparray | $(1, G_{\texttt{act}}, p, p)$ | For each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion, $n_k\mathcal{I}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{gii} = \frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 29 | local\_gradient | nparray | $(1, G_{\texttt{act}}, p)$ | For each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, i.e., $\nabla_{\beta} \mathcal{L}^{(k)}(\beta_g) =   -(X^{(k)})^{\top} Y^{(k)}_{g} + (X^{(k)})^{\top} \left( \frac{1}{\alpha_g} + Y^{(k)}_{g} \right) \frac{\mu^{(k)}_{g}}{\frac{1}{\alpha_g} + \mu^{(k)}_{g}}$, where $\mu^{(k)}_{g}$ and $Y^{(k)}_{g}$ are both vectors in $\mathbb{R}^{n_k}$ and $\alpha_g$ is a scalar. TODO ref equation. | Each center | Server |
| 29 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Initialized to $\texttt{False}$. | Each center | Server |
| 29 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). The genes which have diverged during the IRLS algorithm and those which have not converged at the end of the prescribed iterations are set to $\texttt{True}$. | Each center | Server |
| 29 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, intialized at $\texttt{np.nan}$ since no nll has been computed at this stage. | Each center | Server |
| 29 | newton\_decrement\_on\_mask | NoneType |  | The newton decrement on the active genes, which is set to $\texttt{None}$ at the beginning. | Each center | Server |
| 29 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, initialized at $0$. | Each center | Server |
| 29 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on during the Fed Proximal Quasi-Newton algorithm, since the server is stateless. | Each center | Server |
| 30 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed as the sum of the local negative log likelihoods with $L^2$ regularization with $\lambda = 10^{-6}$. | Server | Center |
| 30 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Server | Center |
| 30 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
| 30 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, incremented by $1$. | Server | Center |
| 30 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Server | Center |
| 30 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes. To compute the ascent direction, we first compute the global Fisher information matrix for each gene $g$, $n \mathcal{I}_g = \sum_k n_k \mathcal{I}^{(k)}_{g}$ and the global gradient $\nabla_{\beta} \mathcal{L}(\beta_g) = \sum_k \nabla_{\beta} \mathcal{L}^{(k)}(\beta_g)$. From these two quantities, we build the Fisher information and gradients of the regularized negative log likelihood, with $L^2$ regularization $\lambda = 10^{-6}$. We add another regularization term to the Fisher matrix which depends on the iteration number. The goal is for the ascent direction to be close to the gradient for small iterations, and to be close to the real natural gradient descent update near the end of the optimization. The ascent direction is then computed as from the regularized Fisher and gradient (see main paper). Roughly, it is the solution of the linear system $n~\mathcal{I}^{\lambda}_g \Delta_g = \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$, where certain components are dropped in to handle boundary conditions as the optimization is constrained to values of $\beta_g$ in $[-\texttt{max\_beta},\texttt{max\_beta}]$. | Server | Center |
| 30 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which remains unchanged during the first iteration of the Proximal Quasi-Newton algorithm. | Server | Center |
| 30 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes. It is computed as $\nu_g = \Delta_g  \cdot \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$ where $\Delta_g$ is the ascent direction on the active genes and $\mathcal{L}^{\lambda}$ is the regularized log likelihood. | Server | Center |
| 31 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes, passed on without modification. | Each center | Server |
| 31 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Each center | Server |
| 31 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, passed on without modification. | Each center | Server |
| 31 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes, passed on without modification. | Each center | Server |
| 31 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, simply passed on. | Each center | Server |
| 31 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Each center | Server |
| 31 | local\_gradient | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p)$ | For each potential step size $\delta$ and each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g - \delta \Delta_g$ parameter, computed on the local data. | Each center | Server |
| 31 | local\_fisher | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p, p)$ | For each potential step size $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at $\beta_g - \delta \Delta_g$. Formally, $n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}$ where $W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{\delta,ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g - \delta \Delta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))$. | Each center | Server |
| 31 | local\_nll | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$ and for each potential next step $\beta_g - \delta \Delta_g$ for $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$. | Each center | Server |
| 31 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which is simply passed on. | Each center | Server |
| 31 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Each center | Server |
| 32 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
| 32 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed as the sum of the local negative log likelihoods with $L^2$ regularization with $\lambda = 10^{-6}$. | Server | Center |
| 32 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, incremented by $1$. | Server | Center |
| 32 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the new active genes $g$, computed at the new $\beta_g$ iterate. For more details, see description of 19. | Server | Center |
| 32 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. A gene $g$ is considered to have diverged if for all step sizes $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and for the computed ascent direction $\Delta_g$, the Armijo condition is not satisfied, i.e., if $\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_g - \delta \Delta_g) \leq \delta ~ \texttt{PQN\_c1} ~ \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g) \cdot \Delta_g$ where $\mathcal{L}^{\lambda}$ is the regularized negative log likelihood, $\texttt{PQN\_c1}$ is the Armijo parameter which can be set by the user (default is $10^{-4}$), and $\nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$ is the gradient of the regularized negative log likelihood. | Server | Center |
| 32 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). Genes that had converged with the relative error criterion or diverged (no stepsize satisfying the Armijo condition) have set to $\texttt{False}$. | Server | Center |
| 32 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}). | Server | Center |
| 32 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the new active genes $g$, computed at the new $\beta_g$ iterate. | Server | Center |
| 33 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Each center | Server |
| 33 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which is simply passed on. | Each center | Server |
| 33 | local\_nll | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$ and for each potential next step $\beta_g - \delta \Delta_g$ for $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$. | Each center | Server |
| 33 | local\_fisher | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p, p)$ | For each potential step size $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at $\beta_g - \delta \Delta_g$. Formally, $n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}$ where $W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{\delta,ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g - \delta \Delta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))$. | Each center | Server |
| 33 | local\_gradient | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p)$ | For each potential step size $\delta$ and each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g - \delta \Delta_g$ parameter, computed on the local data. | Each center | Server |
| 33 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Each center | Server |
| 33 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Each center | Server |
| 33 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, simply passed on. | Each center | Server |
| 33 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes, passed on without modification. | Each center | Server |
| 33 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, passed on without modification. | Each center | Server |
| 33 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes, passed on without modification. | Each center | Server |
| 34 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. As this is the last step of the optimization, a gene $g$ is considered to have diverged not only if the Armijo condition is never satisfied, but also if the convergence criterion is not met. A gene is said to converge if the relative difference between two successive iterates is smaller than a threshold value $\texttt{PQN\_ftol}$, i.e., $\left\|\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_{g,\text{prev}})\right\| \leq \texttt{PQN\_ftol} \max(\mathcal{L}^{\lambda}(\beta_g), \mathcal{L}^{\lambda}(\beta_{g,\text{prev}}),1)$. | Server | Center |
| 34 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}). | Server | Center |
| 34 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
