| ID | Name | Type | Shape | Description | Computed by | Sent to |
|---|---|---|---|---|---|---|
| 1 | local\_H\_matrix | nparray | $(G, p, p)$ | The hat matrix with $\texttt{nan}$ entries for zero genes, used to compute Wald statistics. Should be merged with hat matrix. | Each center | Server |
| 1 | LFC | DataFrame | $(G, p)$ | The log fold changes of the gene expression. This dataframe is indexed by genes on one hand, and by design column names on the other. | Each center | Server |
| 1 | contrast\_vector | nparray | $(p,)$ | The contrast vector to apply to the LFC to get the desired log fold change corresponding to the input contrast of the form Of the form $\texttt{[factor, level1, level2]}$. | Each center | Server |
| 1 | local\_hat\_matrix | nparray | $(G_{\texttt{nz}}, p, p)$ | For each gene $g$, the hat matrix  $H^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$ for parameter $\beta$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 1 | mean\_normed\_counts | nparray | $(G,)$ | For each gene, the mean of the local normed counts, i.e., $\overline{Z}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{Z^{(k)}_{ig}}$. | Each center | Server |
| 1 | n\_samples | int |  | The number of samples in a center $n_k$ for each center $k$. | Each center | Server |
| 1 | varEst | nparray | $(G,)$ | For each gene $g$, the trimmed variance estimate of the normed counts, denoted with $V^{\texttt{trim}}_g$. This quantitiy is retrieved from the current local state. | Each center | Server |
| 1 | \_skip\_cooks | bool |  | A boolean indicating whether to skip the computation of the intermediate quantities to compute the  of the Cook's distance. This is set to $\texttt{True}$ if the Cook's distance is stored in the local state (which is not the case by default due to memory issues). Otherwise, it is set to $\texttt{False}$ (default behaviour). | Each center | Server |
| 2 | p\_values | nparray | $(G,)$ | For each gene, the p-value of the Wald statistic, computed from the survival function of the normal distribution applied to the wald statistic. | Server | Center |
| 2 | wald\_statistics | nparray | $(G,)$ | For each gene, the Wald statistic of the gene expression. This statistics depends on the $\texttt{lfc\_null}$ parameter which sets the null hypothesis on the log fold change (set to $0$ by default), and the $\texttt{alt\_hypothesis}$ parameter, which defines the alternative hypothesis on the log fold change (set to $\texttt{None}$ by default, can be $\texttt{greater}, ~\texttt{greaterAbs}, ~\texttt{less},~ \texttt{lessAbs}$). If the alternative hypothesis is $\texttt{None}$, then the Wald statistic is computed as the centered normalized log fold change. | Server | Center |
| 2 | wald\_se | nparray | $(G,)$ | For each gene, the standard error on the log fold change value for the given contrast given by the GLM. | Server | Center |
| 2 | cooks\_dispersions | nparray | $(G,)$ | For each gene $g$, a robust estimate of the dispersion parameter $\alpha^{\texttt{cooks}}_g$ computed from the trimmed variance estimate and the global mean of the normed counts. We compute this estimate as $\max((V^{\texttt{trim}}_g- \overline{Y}_g)/\overline{Y}_g^2,0.04)$. | Server | Center |
| 2 | global\_hat\_matrix\_inv | nparray | $(G_{\texttt{nz}}, p, p)$ | For each gene $g$, we compute the global hat matrix as the sum of the local hat matrices, and its inverse. | Server | Center |
| 3 | varEst | nparray | $(G,)$ | For each gene $g$, the trimmed variance estimate of the normed counts, denoted with $V^{\texttt{trim}}_g$. This quantitiy is retrieved from the current local state. | Each center | Server |
| 3 | n\_samples | int |  | The number of samples in a center $n_k$ for each center $k$. | Each center | Server |
| 3 | mean\_normed\_counts | nparray | $(G,)$ | For each gene, the mean of the local normed counts, i.e., $\overline{Z}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{Z^{(k)}_{ig}}$. | Each center | Server |
| 3 | \_skip\_cooks | bool |  | A boolean indicating whether to skip the computation of the intermediate quantities to compute the  of the Cook's distance. This is set to $\texttt{True}$ if the Cook's distance is stored in the local state (which is not the case by default due to memory issues). Otherwise, it is set to $\texttt{False}$ (default behaviour). | Each center | Server |
| 3 | cooks\_cutoff | float | $()$ | The cutoff value for the Cook's distance, set to the $0.99$-th quantile of the F-distribution with $p$ and $n-p$ degrees of freedom. | Each center | Server |
| 3 | local\_cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the Cook's distance is above the cutoff value for any sample in the center which i) has not been replaced by an imputation value if Cook's outliers have been refitted and ii) has at least three replicates across all centers. | Each center | Server |
| 3 | local\_hat\_matrix | nparray | $(G_{\texttt{nz}}, p, p)$ | For each gene $g$, the hat matrix  $H^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$ for parameter $\beta$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 4 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a local Cook's outlier in any center. Computed from the local cooks outliers across all centers. | Server | Center |
| 4 | cooks\_cutoff | float | $()$ | The cutoff value for the Cook's distance, set to the $0.99$-th quantile of the F-distribution with $p$ and $n-p$ degrees of freedom. | Server | Center |
| 4 | cooks\_dispersions | nparray | $(G,)$ | For each gene $g$, a robust estimate of the dispersion parameter $\alpha^{\texttt{cooks}}_g$ computed from the trimmed variance estimate and the global mean of the normed counts. We compute this estimate as $\max((V^{\texttt{trim}}_g- \overline{Y}_g)/\overline{Y}_g^2,0.04)$. | Server | Center |
| 4 | global\_hat\_matrix\_inv | nparray | $(G_{\texttt{nz}}, p, p)$ | For each gene $g$, we compute the global hat matrix as the sum of the local hat matrices, and its inverse. | Server | Center |
| 5 | local\_max\_cooks | nparray | $(G_{\texttt{act}},)$ | For each gene $g$ which has a Cook's outlier, the maximum Cook's distance across all samples in the center, if there is one above the cutoff value. Otherwise, $0$. | Each center | Server |
| 5 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a Cook's outlier in any center. Passed on without modification. | Each center | Server |
| 6 | max\_cooks | nparray | $(G_{\texttt{act}},)$ | For each gene $g$ which has a Cook's outlier, the maximum Cook's distance across all samples in all centers, if there is one above the cutoff value. Otherwise, $0$. Computed from the local max cooks across all centers. | Server | Center |
| 6 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a Cook's outlier in any center. Passed on without modification. | Server | Center |
| 7 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a Cook's outlier in any center. Passed on without modification. | Each center | Server |
| 7 | local\_max\_cooks\_gene\_counts | MaskedArray | $(G_{\texttt{act}},)$ | A masked array where for each gene $g$ with a Cook's outliers, the gene is masked if the sample maximizing the Cook's distance is not in the center, and the count value of the sample maximizing the Cook's distance otherwise. | Each center | Server |
| 8 | max\_cooks\_gene\_counts | MaskedArray | $(G_{\texttt{act}},)$ | A masked array where for each gene $g$ with a Cook's outliers, we have the minimum of the counts maximizing the Cook's distance across all centers. Should not be masked. | Server | Center |
| 8 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a Cook's outlier in any center. Passed on without modification. | Server | Center |
| 9 | local\_num\_samples\_above | MaskedArray | $(G_{\texttt{act}},)$ | For each gene $g$ which has a Cook's outlier, the number of samples in the center whose gene count for gene $g$ is above the gene count of the sample maximizing the Cook's distance across all centers for that gene. | Each center | Server |
| 9 | cooks\_outliers | nparray | $(G,)$ | A boolean array which for each gene $g$ indicates if the gene is a Cook's outlier in any center. Passed on without modification. | Each center | Server |
| 9 | p\_values | nparray | $(G,)$ | For each gene, the p-value of the Wald statistic, computed from the survival function of the normal distribution applied to the wald statistic. Stored in the local state. | Each center | Server |
| 9 | wald\_statistics | nparray | $(G,)$ | For each gene, the Wald statistic of the gene expression. Stored in the local state. | Each center | Server |
| 9 | wald\_se | nparray | $(G,)$ | For each gene, the standard error on the log fold change value for the given contrast given by the GLM. Stored in the local state. | Each center | Server |
| 10 | p\_values | nparray | $(G,)$ | If Cook's filtering is enabled (which is the case by default with the $\texttt{cooks\_filter} $ parameter), then the p-values of genes which have $\leq 2$ samples above the gene count of the sample maximizing the Cook's distance across all centers are set to $\texttt{nan}$. Otherwise, passed on without modification. | Server | Center |
| 10 | wald\_statistics | nparray | $(G,)$ | For each gene, the Wald statistic of the gene expression. Passed on without modification. | Server | Center |
| 10 | wald\_se | nparray | $(G,)$ | For each gene, the standard error on the log fold change value for the given contrast given by the GLM. Passed on without modification. | Server | Center |
