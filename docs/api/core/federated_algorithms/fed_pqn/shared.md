| ID | Name | Type | Shape | Description | Computed by | Sent to |
|---|---|---|---|---|---|---|
| 0 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The updated value of the $\beta$ parameter after applying the IRLS update for the active genes. At the last step, is not updated. | Server | Center |
| 0 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene $g$ is considered to have diverged if any component of $\beta_g \in \mathbb{R}^p$ has absolute value above the threshold $\texttt{max\_beta}$. | Server | Center |
| 0 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose $\beta$ parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene $g$, as $\frac{\left\| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right\|}{\left\| 2  \mathcal{L}(\beta) \right\| + 0.1} $ where $\beta_{g, \text{prev}}$ is the value of $\beta_{g}$ at the previous iteration. If this deviance is smaller than the user inputed $\texttt{beta\_tol}$, the gene is considered to have converged and is set to $\texttt{False}$ in the $\texttt{irls\_mask}$, meaning it will not be optimized further. | Server | Center |
| 0 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log-likelihood at the $\beta_g$ parameter, built by summing the local nlls from the centers. | Server | Center |
| 0 | round\_number\_irls | int |  | The current round number of the IRLS algorithm, incremented by $1$ during the local step. | Server | Center |
| 1 | ascent\_direction\_on\_mask | NoneType |  | The ascent direction on the active genes, which is set to $\texttt{None}$ at the beginning. | Each center | Server |
| 1 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, initialized at $0$. | Each center | Server |
| 1 | newton\_decrement\_on\_mask | NoneType |  | The newton decrement on the active genes, which is set to $\texttt{None}$ at the beginning. | Each center | Server |
| 1 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, intialized at $\texttt{np.nan}$ since no nll has been computed at this stage. | Each center | Server |
| 1 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). The genes which have diverged during the IRLS algorithm and those which have not converged at the end of the prescribed iterations are set to $\texttt{True}$. | Each center | Server |
| 1 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on during the Fed Proximal Quasi-Newton algorithm, since the server is stateless. | Each center | Server |
| 1 | local\_gradient | nparray | $(1, G_{\texttt{act}}, p)$ | For each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, i.e., $\nabla_{\beta} \mathcal{L}^{(k)}(\beta_g) =   -(X^{(k)})^{\top} Y^{(k)}_{g} + (X^{(k)})^{\top} \left( \frac{1}{\alpha_g} + Y^{(k)}_{g} \right) \frac{\mu^{(k)}_{g}}{\frac{1}{\alpha_g} + \mu^{(k)}_{g}}$, where $\mu^{(k)}_{g}$ and $Y^{(k)}_{g}$ are both vectors in $\mathbb{R}^{n_k}$ and $\alpha_g$ is a scalar. TODO ref equation. | Each center | Server |
| 1 | local\_fisher | nparray | $(1, G_{\texttt{act}}, p, p)$ | For each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion, $n_k\mathcal{I}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{gii} = \frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 1 | local\_nll | nparray | $(1, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$. | Each center | Server |
| 1 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For evert gene $g$, the inital value of the $\beta_g$ parameter for the ProxQuasiNewton algorithm (PQN), which is either i) the value computed by IRLS if IRLS has converged on that gene (in that case, the gene will not be optimized), or ii) the initial value of the $\beta_g$ parameter for the IRLS algorithm, if IRLS has not converged on that gene. | Each center | Server |
| 1 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Initialized to $\texttt{False}$. | Each center | Server |
| 2 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
| 2 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed as the sum of the local negative log likelihoods with $L^2$ regularization with $\lambda = 10^{-6}$. | Server | Center |
| 2 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, incremented by $1$. | Server | Center |
| 2 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes. It is computed as $\nu_g = \Delta_g  \cdot \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$ where $\Delta_g$ is the ascent direction on the active genes and $\mathcal{L}^{\lambda}$ is the regularized log likelihood. | Server | Center |
| 2 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes. To compute the ascent direction, we first compute the global Fisher information matrix for each gene $g$, $n \mathcal{I}_g = \sum_k n_k \mathcal{I}^{(k)}_{g}$ and the global gradient $\nabla_{\beta} \mathcal{L}(\beta_g) = \sum_k \nabla_{\beta} \mathcal{L}^{(k)}(\beta_g)$. From these two quantities, we build the Fisher information and gradients of the regularized negative log likelihood, with $L^2$ regularization $\lambda = 10^{-6}$. We add another regularization term to the Fisher matrix which depends on the iteration number. The goal is for the ascent direction to be close to the gradient for small iterations, and to be close to the real natural gradient descent update near the end of the optimization. The ascent direction is then computed as from the regularized Fisher and gradient (see main paper). Roughly, it is the solution of the linear system $n~\mathcal{I}^{\lambda}_g \Delta_g = \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$, where certain components are dropped in to handle boundary conditions as the optimization is constrained to values of $\beta_g$ in $[-\texttt{max\_beta},\texttt{max\_beta}]$. | Server | Center |
| 2 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Server | Center |
| 2 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which remains unchanged during the first iteration of the Proximal Quasi-Newton algorithm. | Server | Center |
| 2 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Server | Center |
| 3 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes, passed on without modification. | Each center | Server |
| 3 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes, passed on without modification. | Each center | Server |
| 3 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Each center | Server |
| 3 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, passed on without modification. | Each center | Server |
| 3 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, simply passed on. | Each center | Server |
| 3 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Each center | Server |
| 3 | local\_gradient | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p)$ | For each potential step size $\delta$ and each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g - \delta \Delta_g$ parameter, computed on the local data. | Each center | Server |
| 3 | local\_fisher | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p, p)$ | For each potential step size $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at $\beta_g - \delta \Delta_g$. Formally, $n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}$ where $W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{\delta,ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g - \delta \Delta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))$. | Each center | Server |
| 3 | local\_nll | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$ and for each potential next step $\beta_g - \delta \Delta_g$ for $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$. | Each center | Server |
| 3 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which is simply passed on. | Each center | Server |
| 3 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Each center | Server |
| 4 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed as the sum of the local negative log likelihoods with $L^2$ regularization with $\lambda = 10^{-6}$. | Server | Center |
| 4 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
| 4 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, incremented by $1$. | Server | Center |
| 4 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the new active genes $g$, computed at the new $\beta_g$ iterate. For more details, see description of 19. | Server | Center |
| 4 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the new active genes $g$, computed at the new $\beta_g$ iterate. | Server | Center |
| 4 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. A gene $g$ is considered to have diverged if for all step sizes $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and for the computed ascent direction $\Delta_g$, the Armijo condition is not satisfied, i.e., if $\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_g - \delta \Delta_g) \leq \delta ~ \texttt{PQN\_c1} ~ \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g) \cdot \Delta_g$ where $\mathcal{L}^{\lambda}$ is the regularized negative log likelihood, $\texttt{PQN\_c1}$ is the Armijo parameter which can be set by the user (default is $10^{-4}$), and $\nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)$ is the gradient of the regularized negative log likelihood. | Server | Center |
| 4 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). Genes that had converged with the relative error criterion or diverged (no stepsize satisfying the Armijo condition) have set to $\texttt{False}$. | Server | Center |
| 4 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}). | Server | Center |
| 5 | round\_number\_PQN | int |  | The current round number of the Proximal Quasi-Newton algorithm, passed on without modification. | Each center | Server |
| 5 | newton\_decrement\_on\_mask | nparray | $(G_{\texttt{act}},)$ | The newton decrement on the active genes, passed on without modification. | Each center | Server |
| 5 | global\_reg\_nll | nparray | $(G_{\texttt{nz}},)$ | The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, simply passed on. | Each center | Server |
| 5 | PQN\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification. | Each center | Server |
| 5 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$, which is simply passed on. | Each center | Server |
| 5 | local\_gradient | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p)$ | For each potential step size $\delta$ and each gene $g$, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g - \delta \Delta_g$ parameter, computed on the local data. | Each center | Server |
| 5 | local\_fisher | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}}, p, p)$ | For each potential step size $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$, and each gene $g$, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at $\beta_g - \delta \Delta_g$. Formally, $n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}$ where $W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{\delta,ig}$ is the expected value of the gene $g$ for sample $i$ for parameter $\beta_g - \delta \Delta_g$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))$. | Each center | Server |
| 5 | local\_nll | nparray | $(N_{\texttt{ls}}, G_{\texttt{act}})$ | The nll of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data, for each gene $g$ and for each potential next step $\beta_g - \delta \Delta_g$ for $\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}$. | Each center | Server |
| 5 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Each center | Server |
| 5 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification. | Each center | Server |
| 5 | ascent\_direction\_on\_mask | nparray | $(G_{\texttt{act}}, p)$ | The ascent direction on the active genes, passed on without modification. | Each center | Server |
| 6 | PQN\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. As this is the last step of the optimization, a gene $g$ is considered to have diverged not only if the Armijo condition is never satisfied, but also if the convergence criterion is not met. A gene is said to converge if the relative difference between two successive iterates is smaller than a threshold value $\texttt{PQN\_ftol}$, i.e., $\left\|\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_{g,\text{prev}})\right\| \leq \texttt{PQN\_ftol} \max(\mathcal{L}^{\lambda}(\beta_g), \mathcal{L}^{\lambda}(\beta_{g,\text{prev}}),1)$. | Server | Center |
| 6 | beta | nparray | $(G_{\texttt{nz}}, p)$ | For each gene $g$, the log fold change $\beta_g$. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}). | Server | Center |
| 6 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification. | Server | Center |
