| ID | Name | Type | Shape | Description | Computed by | Sent to |
|---|---|---|---|---|---|---|
| 0 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The initial value of the $\beta$ parameter. If the Gramm matrix is full rank, is set to $\beta_g = G^{-1}(\sum_k\Phi^{(k)}_{g})$ for all genes $g$. Otherwise, it is set as a weighed average of the normed log means, i.e., $\beta_g = \sum_k \tfrac{n_k}{n}~\overline{\log(Z)}^{(k)}_{g}$, where $\overline{\log(Z)}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{\log(Z^{(k)}_{ig})}$ is computed locally. | Server | Center |
| 0 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Initialized to $\texttt{False}$. | Server | Center |
| 0 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Initialized to $\texttt{True}$. | Server | Center |
| 0 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log likelihood of the negative binomial GLM, initialized at $1000$ for all genes. | Server | Center |
| 0 | round\_number\_irls | int |  | The current round number of the IRLS algorithm. Initialized at $0$. | Server | Center |
| 1 | round\_number\_irls | int |  | The current round number of the IRLS algorithm. Simply passed on. | Each center | Server |
| 1 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log likelihood at the $\beta_g$ parameter. Simply passed on. | Each center | Server |
| 1 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Simply passed on. | Each center | Server |
| 1 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on. | Each center | Server |
| 1 | irls\_gene\_names | Index | $(G_{\texttt{act}},)$ | The gene names of the active genes. | Each center | Server |
| 1 | local\_features | nparray | $(G_{\texttt{act}}, p)$ | For each active gene $g$, the projected features $(X^{(k)})^{\top} W^{(k)}_g \phi^{(k)}_{g}$, where $\phi^{(k)}_{ig} = \log\left(\frac{\mu^{(k)}_{ig}}{\gamma_{i}}\right) + \frac{Y^{(k)}_{ig} - \mu^{(k)}_{ig}}{\mu^{(k)}_{ig}}$ and $\phi^{(k)}_{g}$ is the vector of $(\phi^{(k)}_{ig})_{1 \leq i \leq n_k}$. | Each center | Server |
| 1 | local\_hat\_matrix | nparray | $(G_{\texttt{act}}, p, p)$ | For each gene $g$, the hat matrix  $H^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\alpha_g$ is the dispersion estimate of the gene and $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$ for parameter $\beta$, that is $\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)$. | Each center | Server |
| 1 | local\_nll | nparray | $(G_{\texttt{act}},)$ | For each gene $g$, the negative log likelihood of the negative binomial GLM with fixed dispersion at the $\beta_g$ parameter, computed on the local data. | Each center | Server |
| 1 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The log fold change $\beta$ parameter. Not modified. | Each center | Server |
| 2 | beta | nparray | $(G_{\texttt{nz}}, p)$ | The updated value of the $\beta$ parameter after applying the IRLS update for the active genes. At the last step, is not updated. | Server | Center |
| 2 | irls\_diverged\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene $g$ is considered to have diverged if any component of $\beta_g \in \mathbb{R}^p$ has absolute value above the threshold $\texttt{max\_beta}$. | Server | Center |
| 2 | irls\_mask | nparray | $(G_{\texttt{nz}},)$ | A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose $\beta$ parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene $g$, as $\frac{\left\| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right\|}{\left\| 2  \mathcal{L}(\beta) \right\| + 0.1} $ where $\beta_{g, \text{prev}}$ is the value of $\beta_{g}$ at the previous iteration. If this deviance is smaller than the user inputed $\texttt{beta\_tol}$, the gene is considered to have converged and is set to $\texttt{False}$ in the $\texttt{irls\_mask}$, meaning it will not be optimized further. | Server | Center |
| 2 | global\_nll | nparray | $(G_{\texttt{nz}},)$ | For each gene $g$, the negative log-likelihood at the $\beta_g$ parameter, built by summing the local nlls from the centers. | Server | Center |
| 2 | round\_number\_irls | int |  | The current round number of the IRLS algorithm, incremented by $1$ during the local step. | Server | Center |
