| ID | Name | Type | Shape | Description | Computed by | Sent to |
|---|---|---|---|---|---|---|
| 1 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 1 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between $\texttt{min\_disp}$ $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 1 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between $\texttt{min\_disp}$ and $\max(\texttt{max\_disp},n)$ of size $N_{\texttt{gs}}$. | Each center | Server |
| 1 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 1 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 2 | genewise\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 2 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 2 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
| 3 | nll | nparray | $(G, N_{\texttt{gs}})$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the negative log likelihood of the negative binomial GLM with fixed mean parameters $\mu^{(k)}_{ig}$ over the set of local samples and dispersion parameter $\alpha_g$. If the number of unique levels of all factors is equal to the number of parameters $p$, then $\mu^{(k)}_{ig}$ is defined as $\texttt{nan}$ for zero genes, and as the minimum of $\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g$ and $\texttt{min\_mu}:=0.5$ (for the definition of $G$ and $\Phi_g$, see step 8). Otherwise, $\mu^{(k)}_{ig}$ is defined as $\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)$ on non-zero genes, where $\beta_g$ is the log fold change result of the IRLS algorithm, and as $\texttt{nan}$ on zero genes. | Each center | Server |
| 3 | CR\_summand | nparray | $(G, N_{\texttt{gs}}, p, p)$ | For all genes $g$ and all dispersion values $\alpha_g$ in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$, the matrix of the Cox-Reid regularization term pertaining to the samples in the center $k$. This matrix is computed as $\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}$ where $W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}$ is the diagonal matrix with diagonal entries $\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}$ for $1 \leq i \leq n_k$. $\mu^{(k)}_{ig}$ is the expected value of the gene for sample $i$, whose expression can be found in the description of the nll variable. | Each center | Server |
| 3 | grid | nparray | $(G, N_{\texttt{gs}})$ | The logarithmic grid between the exponential of the lower log bound and of the upper log bound of size $N_{\texttt{gs}}$. | Each center | Server |
| 3 | max\_disp | int |  | The effective maximum value of the dispersion parameter $\max(\texttt{max\_disp},n)$. | Each center | Server |
| 3 | non\_zero | nparray | $(G,)$ | A boolean array indicating which genes have non-zero counts in at least one center. | Each center | Server |
| 4 | genewise\_dispersions | nparray | $(G,)$ | For each gene $g$, the current estimate of the dispersion parameter $\alpha_g$. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size $N_{\texttt{gs}}$. | Server | Center |
| 4 | lower\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the maximum of the log of the min dispersion and $\alpha_g - \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter. | Server | Center |
| 4 | upper\_log\_bounds | nparray | $(G,)$ | For each gene $g$, the minimum of the log of the max dispersion and  $\alpha_g + \delta$ where $\delta$ is the current mesh size of the grid and $\alpha_g$ is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter. | Server | Center |
