
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A federated learning implementation of DESeq2 for differential expression analysis.">
      
      
        <meta name="author" content="Boris Muzellec, Ulysse Marteau-Ferey, Tangy Marchand">
      
      
        <link rel="canonical" href="https://github.com/owkin/fedpydeseq2/api/core/deseq2_core/deseq2_lfc_dispersions/shared/">
      
      
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Shared - FedPyDESeq2</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../css/timeago.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../../../../sg_gallery-rendered-html.css">
    
      <link rel="stylesheet" href="../../../../../sg_gallery-binder.css">
    
      <link rel="stylesheet" href="../../../../../sg_gallery.css">
    
      <link rel="stylesheet" href="../../../../../sg_gallery-dataframe.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="FedPyDESeq2" class="md-header__button md-logo" aria-label="FedPyDESeq2" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FedPyDESeq2
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shared
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/owkin/fedpydeseq2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    owkin/fedpydeseq2
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="FedPyDESeq2" class="md-nav__button md-logo" aria-label="FedPyDESeq2" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FedPyDESeq2
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/owkin/fedpydeseq2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    owkin/fedpydeseq2
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    General
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            General
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/installation_developers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation for developers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../usage/references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../generated/gallery/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../generated/gallery/plot_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FedPyDESeq2 demo on the TCGA-LUAD dataset.
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../fedpydeseq2_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running an experiment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deseq2_core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../build_design_matrix/build_design_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build design matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compute_size_factors/compute_size_factors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute size factors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deseq2_lfc_dispersions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Estimating LFCs and dispersions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compute_cook_distance/compute_cook_distance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computing the Cooks distance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../replace_outliers/replace_outliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Replacing outliers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../replace_refitted_values/replace_refitted_values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Replace refitted values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deseq2_stats/deseq2_stats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computing statistics and p-values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../save_pipeline_results/save_pipeline_results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Saving results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../substra_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Substra
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Federated algorithms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Federated algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../federated_algorithms/federated_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../federated_algorithms/compute_trimmed_mean/compute_trimmed_mean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute trimmed mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../federated_algorithms/dispersions_grid_search/dispersions_grid_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute dispersions with grid search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../federated_algorithms/fed_irls/fed_irls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Federated IRLS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../federated_algorithms/fed_pqn/fed_pqn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Federated ProxQuasiNewton
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Shared</h1>

<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Type</th>
<th>Shape</th>
<th>Description</th>
<th>Computed by</th>
<th>Sent to</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>local_gram_matrix</td>
<td>nparray</td>
<td><span class="arithmatex">\((p, p)\)</span></td>
<td>The gram matrix of the local design matrix <span class="arithmatex">\(G^{(k)} := (X^{(k)})^{\top}X^{(k)}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>0</td>
<td>local_features</td>
<td>nparray</td>
<td><span class="arithmatex">\((p, G)\)</span></td>
<td><span class="arithmatex">\(\Phi^{(k)}  := X^{(k)\top} Z^{(k)}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>1</td>
<td>rough_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A rough estimate of the dispersions obtained by essentially averaging local rough dispersions (<span class="arithmatex">\(\alpha^{\texttt{MoM},2}_g = \max(\tfrac{1}{n-p}\sum_k(\alpha^{\texttt{MoM},2}_g)^{(k)},0)\)</span>)</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>2</td>
<td>local_inverse_size_mean</td>
<td>float</td>
<td><span class="arithmatex">\(()\)</span></td>
<td>The average of the inverse of the size factors in a center <span class="arithmatex">\(\overline{1/\gamma}^{(k)} = \tfrac{1}{n_k}\sum_{i=1}^{n_k} 1/\gamma^{(k)}_{i}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>2</td>
<td>local_counts_mean</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>The averag e of the counts in a center, per gene <span class="arithmatex">\(\overline{Y}^{(k)}_{g} = \frac{1}{n_k}\sum_{i=1}^{n_k}Y^{(k)}_{ig}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>2</td>
<td>local_squared_squared_mean</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>The average of the square normed counts in a center, per gene <span class="arithmatex">\(\overline{Y^2} := \tfrac{1}{n_k}\sum_{i=1}^{n_k}(Y^{(k)}_{ig})^2\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>2</td>
<td>local_n_obs</td>
<td>int</td>
<td></td>
<td>The number of observations in a center <span class="arithmatex">\(n_k\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>2</td>
<td>rough_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>The rough estimates computed at the previous step and passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>3</td>
<td>tot_counts_mean</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>The average of the counts across all centers, per gene, obtained by summing the local counts means.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>3</td>
<td>tot_num_samples</td>
<td>int</td>
<td></td>
<td>The total number of samples across all centers <span class="arithmatex">\(n\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>3</td>
<td>MoM_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>The dispersions obtained by the method of moments. First, the aggregated mean counts, squared mean counts and inverse size factors are computed (<span class="arithmatex">\(\overline{1/\gamma} = \sum_k{\tfrac{n_k}{n}~\overline{1/\gamma}^{(k)}) }\)</span>, <span class="arithmatex">\(\overline{Y}_g = \sum_{k}{\tfrac{n_k}{n}~\overline{Y}^{(k)}_{g}}\)</span>, <span class="arithmatex">\(\overline{Y^2} = \sum_{k}{\tfrac{n_k}{n}~\overline{Y^2}^{(k)}_{g})}\)</span>). The variance is then estimated with <span class="arithmatex">\(\widehat{\sigma}^2_g = \tfrac{n}{n-1} (\overline{Y^2}_g - \overline{Y}_g^2)\)</span> and a method of moments estimate is the constructed as <span class="arithmatex">\(\alpha^{\texttt{MoM},1}_g = \tfrac{\widehat{\sigma}^2_g - \overline{1/\gamma}_g \times \overline{Y}_g}{\overline{Y}_g^2}\)</span>. The final MoM estimate <span class="arithmatex">\(\alpha^{\texttt{MoM}}_g\)</span> for gene <span class="arithmatex">\(g\)</span> is the clipped value of <span class="arithmatex">\(\min(\alpha^{\texttt{MoM},1}_g, \alpha^{\texttt{MoM},2}_g)\)</span> between <span class="arithmatex">\(\texttt{min\_disp}\)</span> and <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>3</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>5</td>
<td>gram_full_rank</td>
<td>bool</td>
<td><span class="arithmatex">\(()\)</span></td>
<td>A boolean indicating whether the global Gramm matrix <span class="arithmatex">\(G\)</span> is full rank.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>5</td>
<td>n_non_zero_genes</td>
<td>int</td>
<td></td>
<td>The number of genes with non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>5</td>
<td>local_log_features</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td><span class="arithmatex">\(\Phi_{k} = (X^{(k)})^{\top} \log(Z^{(k)}+0.1)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>5</td>
<td>global_gram_matrix</td>
<td>nparray</td>
<td><span class="arithmatex">\((p, p)\)</span></td>
<td>The sum of the local Gramm matrix across all centers <span class="arithmatex">\(G = \sum_k G^{(k)}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>6</td>
<td>round_number_irls</td>
<td>int</td>
<td></td>
<td>The current round number of the IRLS algorithm. Initialized at <span class="arithmatex">\(0\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>6</td>
<td>global_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log likelihood of the negative binomial GLM, initialized at <span class="arithmatex">\(1000\)</span> for all genes.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>6</td>
<td>irls_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Initialized to <span class="arithmatex">\(\texttt{True}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>6</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Initialized to <span class="arithmatex">\(\texttt{False}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>6</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>The initial value of the <span class="arithmatex">\(\beta\)</span> parameter. If the Gramm matrix is full rank, is set to <span class="arithmatex">\(\beta_g = G^{-1}(\sum_k\Phi^{(k)}_{g})\)</span> for all genes <span class="arithmatex">\(g\)</span>. Otherwise, it is set as a weighed average of the normed log means, i.e., <span class="arithmatex">\(\beta_g = \sum_k \tfrac{n_k}{n}~\overline{\log(Z)}^{(k)}_{g}\)</span>, where <span class="arithmatex">\(\overline{\log(Z)}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{\log(Z^{(k)}_{ig})}\)</span> is computed locally.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>7</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>The updated value of the <span class="arithmatex">\(\beta\)</span> parameter after applying the IRLS update for the active genes. At the last step, is not updated.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>7</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene <span class="arithmatex">\(g\)</span> is considered to have diverged if any component of <span class="arithmatex">\(\beta_g \in \mathbb{R}^p\)</span> has absolute value above the threshold <span class="arithmatex">\(\texttt{max\_beta}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>7</td>
<td>irls_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose <span class="arithmatex">\(\beta\)</span> parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene <span class="arithmatex">\(g\)</span>, as $\frac{\left| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right|}{\left| 2  \mathcal{L}(\beta) \right| + 0.1} $ where <span class="arithmatex">\(\beta_{g, \text{prev}}\)</span> is the value of <span class="arithmatex">\(\beta_{g}\)</span> at the previous iteration. If this deviance is smaller than the user inputed <span class="arithmatex">\(\texttt{beta\_tol}\)</span>, the gene is considered to have converged and is set to <span class="arithmatex">\(\texttt{False}\)</span> in the <span class="arithmatex">\(\texttt{irls\_mask}\)</span>, meaning it will not be optimized further.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>7</td>
<td>global_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log-likelihood at the <span class="arithmatex">\(\beta_g\)</span> parameter, built by summing the local nlls from the centers.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>7</td>
<td>round_number_irls</td>
<td>int</td>
<td></td>
<td>The current round number of the IRLS algorithm, incremented by <span class="arithmatex">\(1\)</span> during the local step.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>8</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>8</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. As this is the last step of the optimization, a gene <span class="arithmatex">\(g\)</span> is considered to have diverged not only if the Armijo condition is never satisfied, but also if the convergence criterion is not met. A gene is said to converge if the relative difference between two successive iterates is smaller than a threshold value <span class="arithmatex">\(\texttt{PQN\_ftol}\)</span>, i.e., <span class="arithmatex">\(\left\|\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_{g,\text{prev}})\right\| \leq \texttt{PQN\_ftol} \max(\mathcal{L}^{\lambda}(\beta_g), \mathcal{L}^{\lambda}(\beta_{g,\text{prev}}),1)\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>8</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}).</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>10</td>
<td>unique_counts</td>
<td>Series</td>
<td><span class="arithmatex">\((p,)\)</span></td>
<td>A pandas series indexed by unique level combinations (all design factor levels that coexist) and containing the number of samples in each level combination. In the single factor case the index will simply be the unique levels of the factor.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>11</td>
<td>counts_by_lvl</td>
<td>Series</td>
<td><span class="arithmatex">\((L,)\)</span></td>
<td>A pandas series indexed by the unique levels of the design factors across all centers, and whose values are the number of samples in each level combination.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>14</td>
<td>nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the negative log likelihood of the negative binomial GLM with fixed mean parameters <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> over the set of local samples and dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. If the number of unique levels of all factors is equal to the number of parameters <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\texttt{nan}\)</span> for zero genes, and as the minimum of <span class="arithmatex">\(\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g\)</span> and <span class="arithmatex">\(\texttt{min\_mu}:=0.5\)</span> (for the definition of <span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(\Phi_g\)</span>, see step 8). Otherwise, <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)\)</span> on non-zero genes, where <span class="arithmatex">\(\beta_g\)</span> is the log fold change result of the IRLS algorithm, and as <span class="arithmatex">\(\texttt{nan}\)</span> on zero genes.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>14</td>
<td>CR_summand</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}}, p, p)\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the matrix of the Cox-Reid regularization term pertaining to the samples in the center <span class="arithmatex">\(k\)</span>. This matrix is computed as <span class="arithmatex">\(\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene for sample <span class="arithmatex">\(i\)</span>, whose expression can be found in the description of the nll variable.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>14</td>
<td>grid</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>The logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> and <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>14</td>
<td>max_disp</td>
<td>int</td>
<td></td>
<td>The effective maximum value of the dispersion parameter <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>14</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>15</td>
<td>upper_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the minimum of the log of the max dispersion and  <span class="arithmatex">\(\alpha_g + \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>15</td>
<td>genewise_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the current estimate of the dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>15</td>
<td>lower_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the maximum of the log of the min dispersion and <span class="arithmatex">\(\alpha_g - \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>16</td>
<td>nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the negative log likelihood of the negative binomial GLM with fixed mean parameters <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> over the set of local samples and dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. If the number of unique levels of all factors is equal to the number of parameters <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\texttt{nan}\)</span> for zero genes, and as the minimum of <span class="arithmatex">\(\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g\)</span> and <span class="arithmatex">\(\texttt{min\_mu}:=0.5\)</span> (for the definition of <span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(\Phi_g\)</span>, see step 8). Otherwise, <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)\)</span> on non-zero genes, where <span class="arithmatex">\(\beta_g\)</span> is the log fold change result of the IRLS algorithm, and as <span class="arithmatex">\(\texttt{nan}\)</span> on zero genes.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>16</td>
<td>CR_summand</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}}, p, p)\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the matrix of the Cox-Reid regularization term pertaining to the samples in the center <span class="arithmatex">\(k\)</span>. This matrix is computed as <span class="arithmatex">\(\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene for sample <span class="arithmatex">\(i\)</span>, whose expression can be found in the description of the nll variable.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>16</td>
<td>grid</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>The logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>16</td>
<td>max_disp</td>
<td>int</td>
<td></td>
<td>The effective maximum value of the dispersion parameter <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>16</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>17</td>
<td>lower_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the maximum of the log of the min dispersion and <span class="arithmatex">\(\alpha_g - \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>17</td>
<td>upper_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the minimum of the log of the max dispersion and  <span class="arithmatex">\(\alpha_g + \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>17</td>
<td>genewise_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the current estimate of the dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices. The Cox-Reid regularized nll per gene and per dispersion in the grid is obtained by summing the regularization term and the nll. Finally, for every gene, the dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>18</td>
<td>mean_normed_counts</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene, the mean of the local normed counts, i.e., <span class="arithmatex">\(\overline{Z}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{Z^{(k)}_{ig}}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>18</td>
<td>n_obs</td>
<td>int</td>
<td></td>
<td>The number of samples in the center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>18</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>18</td>
<td>genewise_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the current estimate of the dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>, as computed by the grid search.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>18</td>
<td>n_params</td>
<td>int</td>
<td></td>
<td>The number of parameters in the design matrix, i.e., its number of columns.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>19</td>
<td>disp_function_type</td>
<td>str</td>
<td></td>
<td>The type of the dispersion function used to model the dispersions. It can be either "parametric", if the iterative scheme to fit the trend curve has converged, the LBFGS-B method used to fit the parameters has converged, and the coefficienst of the trend curve are non-negative; or "mean" otherwise.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>19</td>
<td>mean_disp</td>
<td>NoneType</td>
<td></td>
<td>None if the dispersion function type is "parametric", and the trimmed mean of the genewise dispersions whose value is above <span class="arithmatex">\(10\times \texttt{min\_disp}\)</span>, with trimming proportion <span class="arithmatex">\(0.001\)</span> otherwise.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>19</td>
<td>fitted_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span> with zero counts across all centers, <span class="arithmatex">\(\texttt{nan}\)</span>. For each non-zero gene <span class="arithmatex">\(g\)</span>, either <span class="arithmatex">\(\alpha_{\texttt{trend}}(\overline{Z}_g)\)</span> if the disp_function_type is "parametric" (i.e., the fitting of the parameters has converged), or <span class="arithmatex">\(\texttt{mean\_disp}\)</span> otherwise (i.e., if the disp_function_type is "mean"). Denoted with <span class="arithmatex">\(\alpha^{\texttt{trend}}_g\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>19</td>
<td>_squared_logres</td>
<td>float</td>
<td><span class="arithmatex">\(()\)</span></td>
<td>The squared mean absolute deviation of the difference between the log of the genewise dispersions and the log of the fitted dispersions, restricted to the non-zero genes whose gene-wise dispersions are above <span class="arithmatex">\(100\times \texttt{min\_disp}\)</span>. The mean absolute deviation estimate is defined as the median of the absolute difference between the log residual and its median, scaled by the percent point function of the normal distribution at <span class="arithmatex">\(0.75\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>19</td>
<td>prior_disp_var</td>
<td>float</td>
<td><span class="arithmatex">\(()\)</span></td>
<td>A prior on the variance of the log dispersions around the log trend curve <span class="arithmatex">\(\sigma_{\texttt{trend}}^2\)</span>, estimated as the maximum between <span class="arithmatex">\(0.25\)</span> and <span class="arithmatex">\(\texttt{\_squared\_log\_res} - \psi_1((n-p)/2)\)</span>, where <span class="arithmatex">\(\psi_1(f/2)\)</span> is the variance of the log of a <span class="arithmatex">\(\chi^2_f\)</span> distribution. For more details, see \citep{love2014deseq2}.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>19</td>
<td>trend_coeffs</td>
<td>nparray</td>
<td><span class="arithmatex">\((2,)\)</span></td>
<td>The coefficients of the trend curve fitted to the dispersions. We model the dispersions <span class="arithmatex">\(\alpha_g\)</span> of the gene <span class="arithmatex">\(g\)</span> as a sample from an exponential distribution whose mean <span class="arithmatex">\(\alpha_{\texttt{trend}}(\overline{Z}_g)\)</span> is a function of <span class="arithmatex">\(\overline{Z}_g\)</span> parametrized by two coefficients <span class="arithmatex">\(\alpha_0\)</span> and <span class="arithmatex">\(\text{a}_1\)</span>; <span class="arithmatex">\(\alpha_{\texttt{trend}}(\overline{Z}_g) = \alpha_0 + \tfrac{\text{a}_1}{\overline{Z}_g}\)</span>. <span class="arithmatex">\(\alpha_{\texttt{trend}}\)</span> is called the trend curve. The coefficients are <span class="arithmatex">\((\alpha_0, \text{a}_1)\)</span>, and are obtained by starting with the set of non zero genes  and by iteratively i) minimizing the negative log likelihood of the exponential distribution on the set of genes with LBFGS-B and ii) removing the genes where the ratio between the dispersion <span class="arithmatex">\(\alpha_g\)</span> and the trend curve <span class="arithmatex">\(\alpha_{\texttt{trend}}(\overline{Z}_g)\)</span> is above <span class="arithmatex">\(15\)</span> or below <span class="arithmatex">\(10^{-4}\)</span> (we consider these genes as outliers to this model), until the set of genes is stable (see \citep{love2014deseq2} for more details).</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>20</td>
<td>nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the negative log likelihood of the negative binomial GLM with fixed mean parameters <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> over the set of local samples and dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. If the number of unique levels of all factors is equal to the number of parameters <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\texttt{nan}\)</span> for zero genes, and as the minimum of <span class="arithmatex">\(\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g\)</span> and <span class="arithmatex">\(\texttt{min\_mu}:=0.5\)</span> (for the definition of <span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(\Phi_g\)</span>, see step 8). Otherwise, <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)\)</span> on non-zero genes, where <span class="arithmatex">\(\beta_g\)</span> is the log fold change result of the IRLS algorithm, and as <span class="arithmatex">\(\texttt{nan}\)</span> on zero genes.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>20</td>
<td>CR_summand</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}}, p, p)\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the matrix of the Cox-Reid regularization term pertaining to the samples in the center <span class="arithmatex">\(k\)</span>. This matrix is computed as <span class="arithmatex">\(\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene for sample <span class="arithmatex">\(i\)</span>, whose expression can be found in the description of the nll variable.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>20</td>
<td>grid</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>The logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> and <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>20</td>
<td>max_disp</td>
<td>int</td>
<td></td>
<td>The effective maximum value of the dispersion parameter <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>20</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>20</td>
<td>reg</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between <span class="arithmatex">\(\texttt{min\_disp}\)</span> and <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span> of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, a regularization term that is equal to <span class="arithmatex">\(0.5 \times (\log(\alpha_g) - \log(\alpha^{\texttt{trend}}_g))^2/\sigma_{\texttt{trend}}^2\)</span>, and which comes from the prior on the distribution of the log dispersions around the trend curve.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>21</td>
<td>MAP_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the current estimate of the MAP dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices, and the regularization coming from the prior on the log dispersions around the trend curve. The Cox-Reid, prior regularized nll per gene and per dispersion in the grid is obtained by summing the regularization terms and the nll. Finally, for every gene, the MAP dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>21</td>
<td>lower_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the maximum of the log of the min dispersion and <span class="arithmatex">\(\alpha_g - \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>21</td>
<td>upper_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the minimum of the log of the max dispersion and  <span class="arithmatex">\(\alpha_g + \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>22</td>
<td>non_zero</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>A boolean array indicating which genes have non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>22</td>
<td>max_disp</td>
<td>int</td>
<td></td>
<td>The effective maximum value of the dispersion parameter <span class="arithmatex">\(\max(\texttt{max\_disp},n)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>22</td>
<td>reg</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, a regularization term that is equal to <span class="arithmatex">\(0.5 \times (\log(\alpha_g) - \log(\alpha^{\texttt{trend}}_g))^2/\sigma_{\texttt{trend}}^2\)</span>, and which comes from the prior on the distribution of the log dispersions around the trend curve.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>22</td>
<td>CR_summand</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}}, p, p)\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the matrix of the Cox-Reid regularization term pertaining to the samples in the center <span class="arithmatex">\(k\)</span>. This matrix is computed as <span class="arithmatex">\(\text{CR}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene for sample <span class="arithmatex">\(i\)</span>, whose expression can be found in the description of the nll variable.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>22</td>
<td>nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>For all genes <span class="arithmatex">\(g\)</span> and all dispersion values <span class="arithmatex">\(\alpha_g\)</span> in the logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>, the negative log likelihood of the negative binomial GLM with fixed mean parameters <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> over the set of local samples and dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. If the number of unique levels of all factors is equal to the number of parameters <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\texttt{nan}\)</span> for zero genes, and as the minimum of <span class="arithmatex">\(\gamma^{(k)}_{i}~(X^{(k)})^{\top} G^{-1}\Phi_g\)</span> and <span class="arithmatex">\(\texttt{min\_mu}:=0.5\)</span> (for the definition of <span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(\Phi_g\)</span>, see step 8). Otherwise, <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is defined as <span class="arithmatex">\(\gamma^{(k)}_{i}~\exp(X^{(k)}_{i} \cdot \beta_g)\)</span> on non-zero genes, where <span class="arithmatex">\(\beta_g\)</span> is the log fold change result of the IRLS algorithm, and as <span class="arithmatex">\(\texttt{nan}\)</span> on zero genes.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>22</td>
<td>grid</td>
<td>nparray</td>
<td><span class="arithmatex">\((G, N_{\texttt{gs}})\)</span></td>
<td>The logarithmic grid between the exponential of the lower log bound and of the upper log bound of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>23</td>
<td>lower_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the maximum of the log of the min dispersion and <span class="arithmatex">\(\alpha_g - \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as a lower bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>23</td>
<td>upper_log_bounds</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the minimum of the log of the max dispersion and  <span class="arithmatex">\(\alpha_g + \delta\)</span> where <span class="arithmatex">\(\delta\)</span> is the current mesh size of the grid and <span class="arithmatex">\(\alpha_g\)</span> is the current dispersion estimate. This value will be used as an upper bound for the next grid search for the dispersion parameter.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>23</td>
<td>MAP_dispersions</td>
<td>nparray</td>
<td><span class="arithmatex">\((G,)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the current estimate of the MAP dispersion parameter <span class="arithmatex">\(\alpha_g\)</span>. This estimate is computed by first computing the global nll (summing all local nlls)  as well as the global Cox-Reid regularization term, which is half the log determinant of the sum of the local Cox-Reid matrices, and the regularization coming from the prior on the log dispersions around the trend curve. The Cox-Reid, prior regularized nll per gene and per dispersion in the grid is obtained by summing the regularization terms and the nll. Finally, for every gene, the MAP dispersion parameter is estimated by taking the minizer of this regularized nll on the grid of size <span class="arithmatex">\(N_{\texttt{gs}}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>25</td>
<td>gram_full_rank</td>
<td>bool</td>
<td><span class="arithmatex">\(()\)</span></td>
<td>A boolean indicating whether the global Gramm matrix <span class="arithmatex">\(G\)</span> is full rank.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>25</td>
<td>n_non_zero_genes</td>
<td>int</td>
<td></td>
<td>The number of genes with non-zero counts in at least one center.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>25</td>
<td>local_log_features</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td><span class="arithmatex">\(\Phi_{k} = (X^{(k)})^{\top} \log(Z^{(k)}+0.1)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>25</td>
<td>global_gram_matrix</td>
<td>nparray</td>
<td><span class="arithmatex">\((p, p)\)</span></td>
<td>The sum of the local Gramm matrix across all centers <span class="arithmatex">\(G = \sum_k G^{(k)}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>26</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>The initial value of the <span class="arithmatex">\(\beta\)</span> parameter. If the Gramm matrix is full rank, is set to <span class="arithmatex">\(\beta_g = G^{-1}(\sum_k\Phi^{(k)}_{g})\)</span> for all genes <span class="arithmatex">\(g\)</span>. Otherwise, it is set as a weighed average of the normed log means, i.e., <span class="arithmatex">\(\beta_g = \sum_k \tfrac{n_k}{n}~\overline{\log(Z)}^{(k)}_{g}\)</span>, where <span class="arithmatex">\(\overline{\log(Z)}^{(k)}_{g} = \tfrac{1}{n_k}\sum_{i=1}^{n_k}{\log(Z^{(k)}_{ig})}\)</span> is computed locally.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>26</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Initialized to <span class="arithmatex">\(\texttt{False}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>26</td>
<td>irls_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Initialized to <span class="arithmatex">\(\texttt{True}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>26</td>
<td>global_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log likelihood of the negative binomial GLM, initialized at <span class="arithmatex">\(1000\)</span> for all genes.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>26</td>
<td>round_number_irls</td>
<td>int</td>
<td></td>
<td>The current round number of the IRLS algorithm. Initialized at <span class="arithmatex">\(0\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>27</td>
<td>global_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log likelihood at the <span class="arithmatex">\(\beta_g\)</span> parameter. Simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>round_number_irls</td>
<td>int</td>
<td></td>
<td>The current round number of the IRLS algorithm. Simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>irls_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>The log fold change <span class="arithmatex">\(\beta\)</span> parameter. Not modified.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>local_features</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p)\)</span></td>
<td>For each active gene <span class="arithmatex">\(g\)</span>, the projected features <span class="arithmatex">\((X^{(k)})^{\top} W^{(k)}_g \phi^{(k)}_{g}\)</span>, where <span class="arithmatex">\(\phi^{(k)}_{ig} = \log\left(\frac{\mu^{(k)}_{ig}}{\gamma_{i}}\right) + \frac{Y^{(k)}_{ig} - \mu^{(k)}_{ig}}{\mu^{(k)}_{ig}}\)</span> and <span class="arithmatex">\(\phi^{(k)}_{g}\)</span> is the vector of <span class="arithmatex">\((\phi^{(k)}_{ig})_{1 \leq i \leq n_k}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>local_hat_matrix</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the hat matrix  <span class="arithmatex">\(H^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(\frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\alpha_g\)</span> is the dispersion estimate of the gene and <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene for sample <span class="arithmatex">\(i\)</span> for parameter <span class="arithmatex">\(\beta\)</span>, that is <span class="arithmatex">\(\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>local_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed on the local data.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>27</td>
<td>irls_gene_names</td>
<td>Index</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>The gene names of the active genes.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>28</td>
<td>round_number_irls</td>
<td>int</td>
<td></td>
<td>The current round number of the IRLS algorithm, incremented by <span class="arithmatex">\(1\)</span> during the local step.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>28</td>
<td>global_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the negative log-likelihood at the <span class="arithmatex">\(\beta_g\)</span> parameter, built by summing the local nlls from the centers.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>28</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>The updated value of the <span class="arithmatex">\(\beta\)</span> parameter after applying the IRLS update for the active genes. At the last step, is not updated.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>28</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. A gene <span class="arithmatex">\(g\)</span> is considered to have diverged if any component of <span class="arithmatex">\(\beta_g \in \mathbb{R}^p\)</span> has absolute value above the threshold <span class="arithmatex">\(\texttt{max\_beta}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>28</td>
<td>irls_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the IRLS algorithm. Genes whose <span class="arithmatex">\(\beta\)</span> parameter has diverged are removed from the optimization. Moreover, the deviance ratio is computed for each active gene <span class="arithmatex">\(g\)</span>, as $\frac{\left| 2  \mathcal{L}(\beta_g) - 2 \cdot \mathcal{L}(\beta_{g, \text{prev}}) \right|}{\left| 2  \mathcal{L}(\beta) \right| + 0.1} $ where <span class="arithmatex">\(\beta_{g, \text{prev}}\)</span> is the value of <span class="arithmatex">\(\beta_{g}\)</span> at the previous iteration. If this deviance is smaller than the user inputed <span class="arithmatex">\(\texttt{beta\_tol}\)</span>, the gene is considered to have converged and is set to <span class="arithmatex">\(\texttt{False}\)</span> in the <span class="arithmatex">\(\texttt{irls\_mask}\)</span>, meaning it will not be optimized further.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>29</td>
<td>ascent_direction_on_mask</td>
<td>NoneType</td>
<td></td>
<td>The ascent direction on the active genes, which is set to <span class="arithmatex">\(\texttt{None}\)</span> at the beginning.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For evert gene <span class="arithmatex">\(g\)</span>, the inital value of the <span class="arithmatex">\(\beta_g\)</span> parameter for the ProxQuasiNewton algorithm (PQN), which is either i) the value computed by IRLS if IRLS has converged on that gene (in that case, the gene will not be optimized), or ii) the initial value of the <span class="arithmatex">\(\beta_g\)</span> parameter for the IRLS algorithm, if IRLS has not converged on that gene.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>local_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((1, G_{\texttt{act}})\)</span></td>
<td>The nll of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed on the local data, for each gene <span class="arithmatex">\(g\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>local_fisher</td>
<td>nparray</td>
<td><span class="arithmatex">\((1, G_{\texttt{act}}, p, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the Fisher information matrix of the negative binomial GLM with fixed dispersion, <span class="arithmatex">\(n_k\mathcal{I}^{(k)}_{g} = (X^{(k)})^{\top} W^{(k)}_g X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_g \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(W^{(k)}_{gii} = \frac{\mu^{(k)}_{ig}}{1 + \mu^{(k)}_{ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\alpha_g\)</span> is the dispersion estimate of the gene and <span class="arithmatex">\(\mu^{(k)}_{ig}\)</span> is the expected value of the gene <span class="arithmatex">\(g\)</span> for sample <span class="arithmatex">\(i\)</span> for parameter <span class="arithmatex">\(\beta_g\)</span>, that is <span class="arithmatex">\(\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot \beta_g)\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>local_gradient</td>
<td>nparray</td>
<td><span class="arithmatex">\((1, G_{\texttt{act}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed on the local data, i.e., <span class="arithmatex">\(\nabla_{\beta} \mathcal{L}^{(k)}(\beta_g) =   -(X^{(k)})^{\top} Y^{(k)}_{g} + (X^{(k)})^{\top} \left( \frac{1}{\alpha_g} + Y^{(k)}_{g} \right) \frac{\mu^{(k)}_{g}}{\frac{1}{\alpha_g} + \mu^{(k)}_{g}}\)</span>, where <span class="arithmatex">\(\mu^{(k)}_{g}\)</span> and <span class="arithmatex">\(Y^{(k)}_{g}\)</span> are both vectors in <span class="arithmatex">\(\mathbb{R}^{n_k}\)</span> and <span class="arithmatex">\(\alpha_g\)</span> is a scalar. TODO ref equation.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Initialized to <span class="arithmatex">\(\texttt{False}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>PQN_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). The genes which have diverged during the IRLS algorithm and those which have not converged at the end of the prescribed iterations are set to <span class="arithmatex">\(\texttt{True}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>global_reg_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, intialized at <span class="arithmatex">\(\texttt{np.nan}\)</span> since no nll has been computed at this stage.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>newton_decrement_on_mask</td>
<td>NoneType</td>
<td></td>
<td>The newton decrement on the active genes, which is set to <span class="arithmatex">\(\texttt{None}\)</span> at the beginning.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>round_number_PQN</td>
<td>int</td>
<td></td>
<td>The current round number of the Proximal Quasi-Newton algorithm, initialized at <span class="arithmatex">\(0\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>29</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Simply passed on during the Fed Proximal Quasi-Newton algorithm, since the server is stateless.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>30</td>
<td>global_reg_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed as the sum of the local negative log likelihoods with <span class="arithmatex">\(L^2\)</span> regularization with <span class="arithmatex">\(\lambda = 10^{-6}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>round_number_PQN</td>
<td>int</td>
<td></td>
<td>The current round number of the Proximal Quasi-Newton algorithm, incremented by <span class="arithmatex">\(1\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>PQN_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>ascent_direction_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p)\)</span></td>
<td>The ascent direction on the active genes. To compute the ascent direction, we first compute the global Fisher information matrix for each gene <span class="arithmatex">\(g\)</span>, <span class="arithmatex">\(n \mathcal{I}_g = \sum_k n_k \mathcal{I}^{(k)}_{g}\)</span> and the global gradient <span class="arithmatex">\(\nabla_{\beta} \mathcal{L}(\beta_g) = \sum_k \nabla_{\beta} \mathcal{L}^{(k)}(\beta_g)\)</span>. From these two quantities, we build the Fisher information and gradients of the regularized negative log likelihood, with <span class="arithmatex">\(L^2\)</span> regularization <span class="arithmatex">\(\lambda = 10^{-6}\)</span>. We add another regularization term to the Fisher matrix which depends on the iteration number. The goal is for the ascent direction to be close to the gradient for small iterations, and to be close to the real natural gradient descent update near the end of the optimization. The ascent direction is then computed as from the regularized Fisher and gradient (see main paper). Roughly, it is the solution of the linear system <span class="arithmatex">\(n~\mathcal{I}^{\lambda}_g \Delta_g = \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)\)</span>, where certain components are dropped in to handle boundary conditions as the optimization is constrained to values of <span class="arithmatex">\(\beta_g\)</span> in <span class="arithmatex">\([-\texttt{max\_beta},\texttt{max\_beta}]\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>, which remains unchanged during the first iteration of the Proximal Quasi-Newton algorithm.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>30</td>
<td>newton_decrement_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>The newton decrement on the active genes. It is computed as <span class="arithmatex">\(\nu_g = \Delta_g  \cdot \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)\)</span> where <span class="arithmatex">\(\Delta_g\)</span> is the ascent direction on the active genes and <span class="arithmatex">\(\mathcal{L}^{\lambda}\)</span> is the regularized log likelihood.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>31</td>
<td>ascent_direction_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p)\)</span></td>
<td>The ascent direction on the active genes, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>round_number_PQN</td>
<td>int</td>
<td></td>
<td>The current round number of the Proximal Quasi-Newton algorithm, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>newton_decrement_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>The newton decrement on the active genes, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>global_reg_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>PQN_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>local_gradient</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}}, p)\)</span></td>
<td>For each potential step size <span class="arithmatex">\(\delta\)</span> and each gene <span class="arithmatex">\(g\)</span>, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span> parameter, computed on the local data.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>local_fisher</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}}, p, p)\)</span></td>
<td>For each potential step size <span class="arithmatex">\(\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}\)</span>, and each gene <span class="arithmatex">\(g\)</span>, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span>. Formally, <span class="arithmatex">\(n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\alpha_g\)</span> is the dispersion estimate of the gene and <span class="arithmatex">\(\mu^{(k)}_{\delta,ig}\)</span> is the expected value of the gene <span class="arithmatex">\(g\)</span> for sample <span class="arithmatex">\(i\)</span> for parameter <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span>, that is <span class="arithmatex">\(\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>local_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}})\)</span></td>
<td>The nll of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed on the local data, for each gene <span class="arithmatex">\(g\)</span> and for each potential next step <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span> for <span class="arithmatex">\(\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>, which is simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>31</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>32</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>global_reg_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed as the sum of the local negative log likelihoods with <span class="arithmatex">\(L^2\)</span> regularization with <span class="arithmatex">\(\lambda = 10^{-6}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>round_number_PQN</td>
<td>int</td>
<td></td>
<td>The current round number of the Proximal Quasi-Newton algorithm, incremented by <span class="arithmatex">\(1\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>newton_decrement_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>The newton decrement on the new active genes <span class="arithmatex">\(g\)</span>, computed at the new <span class="arithmatex">\(\beta_g\)</span> iterate. For more details, see description of 19.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. A gene <span class="arithmatex">\(g\)</span> is considered to have diverged if for all step sizes <span class="arithmatex">\(\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}\)</span>, and for the computed ascent direction <span class="arithmatex">\(\Delta_g\)</span>, the Armijo condition is not satisfied, i.e., if <span class="arithmatex">\(\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_g - \delta \Delta_g) \leq \delta ~ \texttt{PQN\_c1} ~ \nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g) \cdot \Delta_g\)</span> where <span class="arithmatex">\(\mathcal{L}^{\lambda}\)</span> is the regularized negative log likelihood, <span class="arithmatex">\(\texttt{PQN\_c1}\)</span> is the Armijo parameter which can be set by the user (default is <span class="arithmatex">\(10^{-4}\)</span>), and <span class="arithmatex">\(\nabla_{\beta} \mathcal{L}^{\lambda}(\beta_g)\)</span> is the gradient of the regularized negative log likelihood.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>PQN_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes). Genes that had converged with the relative error criterion or diverged (no stepsize satisfying the Armijo condition) have set to <span class="arithmatex">\(\texttt{False}\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}).</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>32</td>
<td>ascent_direction_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p)\)</span></td>
<td>The ascent direction on the new active genes <span class="arithmatex">\(g\)</span>, computed at the new <span class="arithmatex">\(\beta_g\)</span> iterate.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>33</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>, which is simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>local_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}})\)</span></td>
<td>The nll of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, computed on the local data, for each gene <span class="arithmatex">\(g\)</span> and for each potential next step <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span> for <span class="arithmatex">\(\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>local_fisher</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}}, p, p)\)</span></td>
<td>For each potential step size <span class="arithmatex">\(\delta \in \{1, 1/2, 1/4, ..., 1/2^{N_{\texttt{ls}}-1}\}\)</span>, and each gene <span class="arithmatex">\(g\)</span>, the Fisher information matrix of the negative binomial GLM with fixed dispersion computed at <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span>. Formally, <span class="arithmatex">\(n_k \mathcal{I}^{(k)}_{\delta,g} = (X^{(k)})^{\top} W^{(k)}_{\delta,g} X^{(k)}\)</span> where <span class="arithmatex">\(W^{(k)}_{\delta,g} \in \mathbb{R}^{n_k \times n_k}\)</span> is the diagonal matrix with diagonal entries <span class="arithmatex">\(W^{(k)}_{\delta,gii} = \frac{\mu^{(k)}_{\delta, ig}}{1 + \mu^{(k)}_{\delta, ig} \alpha_g}\)</span> for <span class="arithmatex">\(1 \leq i \leq n_k\)</span>. <span class="arithmatex">\(\alpha_g\)</span> is the dispersion estimate of the gene and <span class="arithmatex">\(\mu^{(k)}_{\delta,ig}\)</span> is the expected value of the gene <span class="arithmatex">\(g\)</span> for sample <span class="arithmatex">\(i\)</span> for parameter <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span>, that is <span class="arithmatex">\(\gamma^{(k)}_{g} \exp(X^{(k)}_{i} \cdot (\beta_g - \delta \Delta_g))\)</span>.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>local_gradient</td>
<td>nparray</td>
<td><span class="arithmatex">\((N_{\texttt{ls}}, G_{\texttt{act}}, p)\)</span></td>
<td>For each potential step size <span class="arithmatex">\(\delta\)</span> and each gene <span class="arithmatex">\(g\)</span>, the gradient of the negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g - \delta \Delta_g\)</span> parameter, computed on the local data.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. Passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>PQN_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes are currently being optimized by the Proximal Quasi-Newton algorithm (active genes),  passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>global_reg_nll</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>The regularized negative log likelihood of the negative binomial GLM with fixed dispersion at the <span class="arithmatex">\(\beta_g\)</span> parameter, simply passed on.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>newton_decrement_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}},)\)</span></td>
<td>The newton decrement on the active genes, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>round_number_PQN</td>
<td>int</td>
<td></td>
<td>The current round number of the Proximal Quasi-Newton algorithm, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>33</td>
<td>ascent_direction_on_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{act}}, p)\)</span></td>
<td>The ascent direction on the active genes, passed on without modification.</td>
<td>Each center</td>
<td>Server</td>
</tr>
<tr>
<td>34</td>
<td>PQN_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the Proximal Quasi-Newton algorithm to diverge. As this is the last step of the optimization, a gene <span class="arithmatex">\(g\)</span> is considered to have diverged not only if the Armijo condition is never satisfied, but also if the convergence criterion is not met. A gene is said to converge if the relative difference between two successive iterates is smaller than a threshold value <span class="arithmatex">\(\texttt{PQN\_ftol}\)</span>, i.e., <span class="arithmatex">\(\left\|\mathcal{L}^{\lambda}(\beta_g) - \mathcal{L}^{\lambda}(\beta_{g,\text{prev}})\right\| \leq \texttt{PQN\_ftol} \max(\mathcal{L}^{\lambda}(\beta_g), \mathcal{L}^{\lambda}(\beta_{g,\text{prev}}),1)\)</span>.</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>34</td>
<td>beta</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}}, p)\)</span></td>
<td>For each gene <span class="arithmatex">\(g\)</span>, the log fold change <span class="arithmatex">\(\beta_g\)</span>. This value has been updated by the Proximal Quasi-Newton algorithm for all active genes where an admissible step size was found using the Armijo condition (see equation 2.5 of \citep{kim2010tackling}).</td>
<td>Server</td>
<td>Center</td>
</tr>
<tr>
<td>34</td>
<td>irls_diverged_mask</td>
<td>nparray</td>
<td><span class="arithmatex">\((G_{\texttt{nz}},)\)</span></td>
<td>A boolean array indicating which non zero genes have caused the IRLS algorithm to diverge. Passed on without modification.</td>
<td>Server</td>
<td>Center</td>
</tr>
</tbody>
</table>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-06-24T07:38:14+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-06-24</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-06-24T07:38:14+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-06-24</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2024-present Owkin Inc.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/owkin/fedpydeseq2" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.copy", "content.tabs.link", "palette.switch", "navigation.indexes"], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../../../js/timeago.min.js"></script>
      
        <script src="../../../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>